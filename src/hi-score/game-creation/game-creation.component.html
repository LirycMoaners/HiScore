<div class="page">
  <section>
    <div class="player-list">
      <h2>Player List</h2>

      <div class="list">
        <mat-form-field>
          <input #newPlayer
            type="text"
            matInput
            [(ngModel)]="newPlayerName"
            (ngModelChange)="filterPlayerList($event)"
            (blur)="onNewPlayerOut($event, newPlayer)"
            (keypress)="onNewPlayerOut($event, newPlayer)"
            [matAutocomplete]="auto2"
            placeholder="Add player"
            aria-label="New player name">
          <mat-autocomplete #auto2="matAutocomplete" (optionSelected)="addPlayer($event.option.value, newPlayer)">
            <mat-option *ngFor="let pl of filteredPlayerList" [value]="pl">{{pl.name}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <div *ngFor="let player of gamePlayerList; let i = index">
          <mat-form-field>
            <input type="text"
              matInput
              [(ngModel)]="gamePlayerList[i].name"
              (ngModelChange)="filterPlayerList($event)"
              (change)="changePlayer(player, $event.target.value)"
              [matAutocomplete]="auto"
              aria-label="Player name">
            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="changePlayer(player, $event.option.value)">
              <mat-option *ngFor="let pl of filteredPlayerList" [value]="pl">{{pl.name}}</mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="game-category">
      <h2>Game Category</h2>

      <mat-form-field>
        <mat-select [(ngModel)]="chosenGameCategory" placeholder="Game category" required role="listbox">
          <mat-option role="option" #gameCategory *ngFor="let cat of gameCategoryList" [value]="cat">{{cat.name}}</mat-option>
        </mat-select>
      </mat-form-field>
      <div>
        <button mat-raised-button (click)="openDialog()">Add category</button>
      </div>
    </div>
  </section>
  <footer>
    <button mat-flat-button cdkfocusinitial color="accent" (click)="startGame()" aria-label="Start game">Start !</button>
  </footer>
</div>
